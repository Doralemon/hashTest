<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>KanDaoBackend-forgotLogin</title><link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="sass/base.min.css"><link rel="stylesheet" href="sass/login.min.css"><link rel="shortcut icon" href="./img/favicon.ico"></head><style>.btnBox,form .form-group{margin-top:20px}.input-group-addon{width:100px}.getCode{cursor:pointer}</style><body><header><img src="img/kandao_logo.png" alt=""></header><div id="login-container"><h3>后台管理系统</h3><div class="login-userInfo"><h4>找回密码</h4><form id="kandao-emailTest"><div class="form-group"><label class="sr-only"></label><div class="input-group"><input type="email" class="form-control" placeholder="邮箱" name="email"><div class="input-group-addon getCode">获取验证码</div></div></div><div class="form-group"><input type="text" class="form-control" placeholder="验证码" name="code"></div><div class="btnBox"><button class="btn btn-default btn-block">验证</button></div></form></div></div><footer><img src="img/kandaobottom.png" alt="" class="logo"></footer></body></html><script src="./js/lib/jquery-2.1.4.js"></script><script src="js/common/api.js"></script><script src="js/lib/jquery.cookie.js"></script><script>function getCode(){$(".getCode").on("click",function(){if(flag){flag=!1;var e=30,a=null,t=$('#kandao-emailTest input[name = "email"]').val(),o={email:t};$.trim(t)?$.ajax({url:api()+"users/password/email",type:"post",data:JSON.stringify(o),dataType:"json",success:function(o){if("0"!=o.code)return 10001==o.code?alert("邮箱错误！"):10104==o.code&&alert("用户不存在!"),void(flag=!0);$(".getCode").html(e+"s");var n=o.result.token;$(".btnBox").attr("token",n),$.cookie("token",JSON.stringify(n)),$.cookie("username",t),getEmailAndCode(),a=setInterval(function(){e--,$(".getCode").html(e+"s"),e<1&&(clearInterval(a),$(".getCode").html("获取验证码"),flag=!0)},1e3)}}):alert("请输入您的邮箱！")}})}function getEmailAndCode(){$("#kandao-emailTest .btnBox").on("click",function(e){e.preventDefault();var a=$('#kandao-emailTest input[name = "email"]').val(),t={email:a,code:$('#kandao-emailTest input[name = "code"]').val()};if($("#login-container").attr("email",a),$.trim(a)){var o=$(".btnBox").attr("token");myAjax({url:"users/password/email_verification",type:"post",data:t,token:o},function(e){location.href="resetPass.html"})}else alert("请输入您的邮箱！")})}var flag=!0;$.cookie("account")&&$('#kandao-emailTest input[name = "email"]').val($.cookie("account")),getCode()</script>