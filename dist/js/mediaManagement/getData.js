define(["jquery","common/amdApi"],function(a,e){return{getListData:function(e){for(var i="",t="",n="",s=0;s<e.result.data.length;s++){var d=e.result.data[s],l="";switch(d.status){case"OF":n="下线";break;case"UP":n="上传成功";break;case"WT":n="等待转码";break;case"TI":n="转码中";break;case"TF":n="转码失败";break;case"QU":n="等待分发";break;case"DI":n="分发成功";break;case"DF":n="分发失败";break;case"In":n="发布成功";break;case"IF":n="发布失败";break;case"SU":case"ON":n="正常"}if(t=d.thumbnail_uri?'<img src="'+d.thumbnail_uri+'">':'<img src="img/giveJpg.jpg">',d.tags.length)for(var o=0;o<d.tags.length;o++)l+='<span class="specificTag">'+d.tags[o][0]+"</span>";else l="";i+='<div class="col-sm-4 col-md-3 mediaBigBox" id="'+d.id+'"><div class="thumbnail"><div class="coverBox"></div><div class="imgTop clearfix"><span class="imgNum pull-left">'+d.index+'</span><label class="checkbox-inline pull-right"><input type="checkbox" ></label><span class="imgState pull-right '+d.status+'">'+n+"</span></div>"+t+'<div class="caption clearfix"><h5 class="title">'+d.name+'</h5><p class=""><span class="resourceTpye pull-left">'+d.m_type+'</span><span class="time pull-right">'+d.date_created+'</span></p></div><div class="tags">'+l+"</div></div></div>"}a(".kandao-mediaManagement").find(".mediaInfoBody").html(i)},myAjax:function(i,t){var n=this;n.getListData(t);var s=Math.ceil(t.result.count/8);t.result.index=s,a(".mediaContainer>p").text("总计"+t.result.count+"条结果"),a(".mediaInfo-bottom>p").text("每页显示8条信息,共"+s+"页");var d;d=s<6?s:6,1==s?a(".pagination").hide():a(".pagination").show(),function(t,s,d){a(".kandao-mediaManagement").find(".pagination").jBootstrapPage({pageSize:t,total:d,pageNow:i.page,maxPageButton:s,onPageClicked:function(a,t){i.page=t+1,e.ajax({url:"medias",type:"get",json:i},function(a){n.getListData(a),n.getSelMedia()})}})}(8,d,t.result.count),i.page>6&&(a(".pagination .goTo input").val(i.page),a(".go").click(),a(".pagination .goTo input").val(""))},getSelMedia:function(){var e=[];return a(".kandao-mediaManagement").find(".thumbnail input").each(function(i,t){if(1==a(t).prop("checked")){var n=a(t).parents(".mediaBigBox").find(".resourceTpye").text(),s=a(t).parents(".mediaBigBox").attr("id");e[e.length]={type:n,id:s}}}),e[0]?(a(".kandao-mediaManagement").find(".dropdown-toggle").removeClass("disabled"),a(".kandao-mediaManagement").find(".transCode").removeClass("disabled")):(a(".kandao-mediaManagement").find(".dropdown-toggle").addClass("disabled"),a(".kandao-mediaManagement").find(".transCode").addClass("disabled")),e}}});