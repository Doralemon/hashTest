define(["jquery","text!tpls/factoryManagementList.html","artTemplate","factoryManagement/newAdd","factoryManagement/edit","factoryManagement/delete","factoryManagement/search","common/amdApi","common/getPage"],function(t,n,a,e,o,i,c,r,d){return function(l){var g=d(t(".kandao-factory"),10,l.falg1),u=g.json,f=g.page;1!=t(".kandao-factory table tbody tr").length||l.falg2||(g.json.page=g.json.page-1||1),r.ajax({url:"productions/factory",type:"get",json:u},function(d){var g=Math.ceil(d.result.count/10);d.result.index=g;var p=a.render(n,d.result),s=t(p).on("click",".newAdd",function(){l.falg1=!1,e()}).on("click",".btn-edit",function(){var n=t(this).parent().attr("id");o(n)}).on("click",".btn-delete",function(){l.falg2=!1;var n=t(this).parent().attr("id");i(n)}).on("click",".factoryserach",function(){t('.kandao-factory input[name = "q"]').val();c()}).on("keydown",'input[name="q"]',function(t){13==t.keyCode&&(t.preventDefault(),s.find(".factoryserach").trigger("click"))});l.falg1=!0,l.falg2=!0,t(".kandao-contentBody").html(s),t(".breadcrumb li").eq(0).on("click",function(){t(".home").trigger("click")});var y;y=g<6?g:6,1==g?t(".pagination").hide():t(".pagination").show(),function(n,a,e){s.find(".pagination").jBootstrapPage({pageSize:n,total:e,pageNow:u.page,maxPageButton:a,onPageClicked:function(n,a){u.page=a+1,r.ajax({url:"productions/factory",type:"get",json:u},function(n){for(var a="",e=0;e<n.result.data.length;e++){var o=n.result.data[e];a+='<tr id="'+o.id+'"><td>'+o.no+"</td><td>"+o.name+"</td><td>"+o.description+"</td><td>"+o.creator+"</td><td>"+o.date_created+'</td><td id="'+o.id+'"><button type="button" class="btn btn-edit btn-sm">编辑</button><button type="button" class="btn btn-delete btn-sm">删除</button></td>'}t(".kandao-factory table tbody").html(a)})}})}(10,y,d.result.count),f>6&&(t(".pagination .goTo input").val(u.page),t(".go").click(),t(".pagination .goTo input").val(""))})}});