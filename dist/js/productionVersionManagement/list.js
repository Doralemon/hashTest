define(["jquery","text!tpls/productionVersionManagementList.html","artTemplate","productionVersionManagement/search","productionVersionManagement/add","productionVersionManagement/edit","productionVersionManagement/info","productionVersionManagement/downLine","common/amdApi","productionVersionManagement/getData","bootstrap","page"],function(t,n,a,e,o,i,r,c,s,u){return function(g){var p=1;g.flag1&&t(".kandao-productionVersion .pagination>li").each(function(n,a){t(a).hasClass("active")&&(p=t(a).attr("pnum"),p=parseInt(p))});var l={limit:10,page:p};1!=t(".kandao-productionVersion table tbody tr").length||g.flag2||(obj.json.page=obj.json.page-1||1),s.ajax({url:"softwares",type:"get",json:l},function(p){var d=Math.ceil(p.result.count/10);p.result.index=d;var f=a.render(n,p.result),m=t(f).on("click",".softwaresSearch",function(){e()}).on("click",".newAdd",function(){g.flag1=!1,o()}).on("click",".btnEdit",function(){var n=this,a=t(this).parents("tr").attr("id");i(a,n)}).on("click",".btnVesion",function(){var n=t(this).parents("tr").attr("id"),a=t(this).parents("tr").children().eq(4).text();r(n,a)}).on("click",".btnDownLine",function(){var n=t(this).parents("tr").attr("id");c(n)}).on("keydown",'input[name="q"]',function(t){13==t.keyCode&&(t.preventDefault(),m.find(".softwaresSearch").trigger("click"))});g.flag1=!0,t(".kandao-contentBody").html(m),t(".breadcrumb li").eq(0).on("click",function(){t(".home").trigger("click")}),u.getListData(p),s.ajax({url:"softwares",type:"get",json:l},function(n){var a=Math.ceil(n.result.count/10);n.result.index=a;var e;e=a<6?a:6,1==a?t(".pagination").hide():t(".pagination").show(),function(n,a,e){t(".kandao-productionVersion").find(".pagination").jBootstrapPage({pageSize:n,total:e,pageNow:l.page,maxPageButton:a,onPageClicked:function(t,n){sessionStorage.setItem("currentPage",n+1);var a={limit:10,page:n+1};s.ajax({url:"softwares",type:"get",json:a},function(t){u.getListData(t)})}})}(10,e,n.result.count),l.page>6&&(t(".pagination .goTo input").val(l.page),t(".go").click(),t(".pagination .goTo input").val(""))})})}});