define(["jquery","text!tpls/mediaManagement/cloumnMenagement.html","artTemplate","common/amdApi","mediaManagement/addColumn","mediaManagement/deleteCloumn","mediaManagement/showClounmInfo","mediaManagement/showClounmSort","mediaManagement/saveCloumnInfo","mediaManagement/cloumnMenagSearch","sortable","mediaManagement/uploadFileRms","bootstrap","page"],function(e,t,a,n,i,o,l,s,d,m,c,r){return function(u,f){e("#cloumnManagement").remove();var g,h,p="1",y=a.render(t,u.result),b=e(y).on("input",".cloumnSearch",function(){var t=e(this).val();m(t)}).on("click",".cloumnAdd",function(){i()}).on("click",".orderByTime",function(){b.find("p").hasClass("glyphicon-sort-by-attributes")?(p="1",b.find("p").removeClass("glyphicon-sort-by-attributes").addClass("glyphicon-sort-by-attributes-alt"),b.find("p").text("按时间降序"),s(g,h,p)):b.find("p").hasClass("glyphicon-sort-by-attributes-alt")&&(p="0",b.find("p").addClass("glyphicon-sort-by-attributes").removeClass("glyphicon-sort-by-attributes-alt"),b.find("p").text("按时间升序"),s(g,h,p))}).on("click",".btnDelete",function(){var t;if(b.find(".tagstoAdd .sBox").each(function(a,n){e(n).hasClass("active")&&(t=e(n).attr("id"))}),!t)return void alert("请选择你要删除的栏目！");o(t)}).on("click",".tagstoAdd .sBox",function(){e(".tagstoAdd").children().removeClass("active"),e(this).addClass("active"),g=e(this).attr("id"),l(g),h=b.find(".resorce").val(),s(g,h,p)}).on("change",".resorce",function(){h=e(this).val(),s(g,h,p)}).on("click",".btnSave",function(){b.find(".tagstoAdd .sBox").each(function(t,a){e(a).hasClass("active")&&(g=e(this).attr("id"))}),g||alert("请选择栏目！"),d(g)}).appendTo("body").modal();e(".tagstoAdd .sBox").first().click();var v=document.getElementById("items");new c(v,{draggable:".list-item"});r(e("#cloumnManagement"),e("#cloumnManagement #clomunImg"),f,function(e){var t={file_hash:e.file_hash,file_url:e.file_url,type:"column",pk:g,file_name:e.file_name,file_size:e.file_size,file_type:e.file_type};n.ajax({url:"medias/upload/thumbnail",type:"post",json:JSON.stringify(t)},function(e){alert("缩略图上传成功!")})})}});