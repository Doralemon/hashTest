define(["jquery","common/amdApi"],function(t,a){return{getListData:function(a){for(var n=[],e=0;e<a.result.data.length;e++){var o=a.result.data[e],i="",d="";switch(o.status){case"R":i="准备转码";break;case"W":i="等待转码";break;case"P":i="转码中";break;case"F":i="转码失败";break;case"S":i="转码成功"}switch(o.m_type){case"photo":d="图片";break;case"video":d="视频";break;case"live":d="直播"}var s='<tr id="'+o.id+'"><td>'+o.name+'</td><td m_type="'+o.m_type+'">'+d+"</td><td>"+i+"</td><td>"+o.date_modified+'</td><td><button type="button" class="btn btnInfo btn-sm">详情</button><button type="button" class="btn btnTransCode btn-sm" style="display:none">转码</button><button type="button" class="btn btnDelete btn-sm">删除</button></td></tr>';n.push(s)}var r=n.join("");t(".kandao-transCodingManagement").find(".mediaContainer tbody").html(r)},myAjax:function(n,e){var o=this;o.getListData(e);var i=Math.ceil(e.result.count/10);e.result.index=i,t(".mediaContainer>p").text("总计"+e.result.count+"条信息"),t(".transCoding-bottom>p").text("每页显示10条信息,共"+i+"页");var d;d=i<6?i:6,1==i?t(".pagination").hide():t(".pagination").show(),function(e,i,d){t(".kandao-transCodingManagement").find(".pagination").jBootstrapPage({pageSize:e,total:d,pageNow:n.page,maxPageButton:i,onPageClicked:function(t,e){n.page=e+1,a.ajax({url:"medias/transcode/task_list",type:"get",json:n},function(t){o.getListData(t)})}})}(10,d,e.result.count),n.page>6&&(t(".pagination .goTo input").val(n.page),t(".go").click(),t(".pagination .goTo input").val(""))},getInfoData:function(a){for(var n=[],e=0;e<a.result.data.length;e++){var o="",i="",d=a.result.data[e];switch(o="F"==d.status?'<button type="button" class="btn btn-sm btnRetry">重试</button><button type="button" class="btn btn-sm btnDelete">删除</button>':'<button type="button" class="btn btn-sm btnDelete">删除</button>',d.status){case"R":i="准备转码";break;case"W":i="等待转码";break;case"P":i="转码中";break;case"F":i="转码失败";break;case"S":i="转码成功"}var o='<tr id="'+d.id+'"><td>'+d.warping+"</td><td>"+d.resolution+"</td><td>"+d.codec+"</td><td>"+d.vbr+"</td><td>"+d.creator+"</td><td>"+d.date_created+"</td><td>"+i+"</td><td>"+o+"</td></tr>";n.push(o)}var s=n.join("");t("#transCodeInfo").find(".codeInitContent tbody").html(s)},myInfoAjax:function(n,e,o){var i=this;i.getInfoData(e);var d=Math.ceil(e.result.count/10);e.result.index=d,t(".codeInitContent>p").text("共计"+e.result.count+"条转码信息"),t(".transCodeInfo-bottom>p").text("每页显示10条信息,共"+d+"页");var s;s=d<6?d:6,1==d?t(".pagination").hide():t(".pagination").show(),function(e,d,s){t("#transCodeInfo").find(".pagination").jBootstrapPage({pageSize:e,total:s,pageNow:n.page,maxPageButton:d,onPageClicked:function(t,e){n.page=e+1,a.ajax({url:"medias/transcode/"+o+"/line_info",type:"get",json:n},function(t){i.getInfoData(t)})}})}(10,s,e.result.count),n.page>6&&(t(".pagination .goTo input").val(n.page),t(".go").click(),t(".pagination .goTo input").val("")),t("#transCodeInfo .pagination>li").removeClass("active"),t("#transCodeInfo .pagination>li>a").each(function(a,e){t(e).attr("page")==n.page&&t(e).parent().addClass("active")})},getInitCodeData:function(a){for(var n=[],e=0;e<a.result.data.length;e++){a.result.data[e];n.push('<tr><td>视频</td><td>Cubemap</td><td>1920*1920</td><td>H264</td><td>4M</td><td><button type="button" class="btn btn-sm btnEdit">编辑</button><button type="button" class="btn btn-sm btnDelete">删除</button></td></tr>')}var o=n.join("");t("#codeInit").find(".codeInitContent tbody").html(o)},myInitCodeAjax:function(n,e,o){var i=this;i.getInitCodeData(e);var d=Math.ceil(e.result.count/10);e.result.index=d;var s;s=d<6?d:6,1==d?t(".pagination").hide():t(".pagination").show(),function(e,d,s){t("#codeInit").find(".pagination").jBootstrapPage({pageSize:e,total:s,pageNow:n.page,maxPageButton:d,onPageClicked:function(t,e){n.page=e+1,a.ajax({url:"medias/transcode/"+o+"/line_info",type:"get",json:n},function(t){i.getInitCodeData(t)})}})}(10,s,e.result.count),n.page>6&&(t(".pagination .goTo input").val(n.page),t(".go").click(),t(".pagination .goTo input").val("")),t("#codeInit .pagination>li").removeClass("active"),t("#codeInit .pagination>li>a").each(function(a,e){t(e).attr("page")==n.page&&t(e).parent().addClass("active")})}}});